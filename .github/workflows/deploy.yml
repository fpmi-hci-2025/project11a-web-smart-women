name: Deploy Frontend

on:
  push:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: List files
      run: ls -la
    
    - name: Verify HTML file
      run: |
        if [ -f "index.html" ]; then
          echo "✅ index.html exists"
          echo "First 3 lines of index.html:"
          head -3 index.html
        else
          echo "❌ index.html not found"
          exit 1
        fi
    
    - name: Verify Dockerfile
      run: |
        if [ -f "Dockerfile" ]; then
          echo "✅ Dockerfile exists"
          cat Dockerfile
        else
          echo "❌ Dockerfile not found"
          exit 1
        fi
    
    - name: Build Docker image
      run: |
        docker build -t onlearn-frontend .
        echo "✅ Docker image built successfully"
    
    - name: Test Docker image
      run: |
        # Просто проверяем, что образ создан
        docker images | grep onlearn-frontend
        echo "✅ Docker image test passed"

    - name: Deploy Notification
      if: github.ref == 'refs/heads/main'
      run: |
        echo "Frontend will be automatically deployed to Render.com"
        echo "Check Render.com dashboard for deployment status"